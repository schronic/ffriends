<% total_price = 0 %>
<% total_items = 0 %>
<% @reservations.each do |reservation| %>
<% total_price += reservation.friend.price %>
<% total_items += 1 %>
<% end %>
<h1>Shopping Cart</h1>
<div class="flex-wrapper">
  <div class="container">
    <div class="cards">
      <div class="card-reservation">
        <% @reservations.each do |reservation| %>
        <div class="reservation">
          <% if reservation.friend.picture.present? %>
          <div class="card-body" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url(<%= cl_image_path(reservation.friend.picture) %>);">
            <% else %>
            <div class="card-body" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url('https://picsum.photos/800/300/?random');">
              <% end %>
              <div class="card-description">
                <p class="friend-number">ID <%= reservation.friend.id %> </p>
              </div>
              <%= link_to "", friend_path(reservation.friend), class: 'card-link' %>
            </div>
            <div class="card-footer">
              <p class="friend-slogan"> <%= reservation.friend.slogan %></p>
              <p class="friend-price"><%= reservation.friend.price %> $ </p>
              <p class="friend-rating">
                <% reservation.friend.rating.times do %>
                <i class="fas fa-star full"></i>
                <% end %>
                <% (5 - reservation.friend.rating).times do %>
                <i class="far fa-star emtpy"></i>
                <% end %>
              </p>
              <p class="friend-slogan">Added: <em><%= reservation.updated_at.strftime("%b %e, %l:%M %p") %></em>
              </p>
            </div>
          </div>
          <% end %>
        </div>
      </div>
    </div>
    <div class="purchase-bar sticky">
  <div class="sticky">
      <h3 id="total">Total: <%= total_price %>$</h3>
      <h4 id="total">Items: <%= total_items %></h4>
          <%= simple_form_for @purchase, url: purchases_path, method: :post do |f| %>
          <%= f.error_notification %>
          <%= f.hidden_field :total_price, value: total_price %>
          <%= f.hidden_field :user_id, value: current_user.id %>
          <%= f.hidden_field :reservation, value: @reservations%>
          <div id="description-button">
            <%= f.button :submit, 'Buy now', class: 'btn btn-danger btn-lg' %>
          <% end %>
    </div>
    </div>
  </div>
</div>

</div>


